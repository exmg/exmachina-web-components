

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: exmg-grid/src/table/exmg-grid.js | Source: exmg-grid/src/table/exmg-grid.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 150px; height: 50px">
        
            <img src="https://www.exmachinagroup.com/images/svg/ExMachinaPrimary.svg" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: exmg-grid/src/table/exmg-grid.js</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Exmg.EditorElement.html">EditorElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Exmg.EditorElement_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Exmg.EditorElement.html#getToolbar">getToolbar</a></li><li><a href="Exmg.EditorElement.html#updateDocHistory">updateDocHistory</a></li></ul></div></li><li><a href="ExmgButton.html">ExmgButton</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgButton_sub"></div></li><li><a href="ExmgCollapsed.html">ExmgCollapsed</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgCollapsed_sub"></div></li><li><a href="ExmgCopyToClipboard.html">ExmgCopyToClipboard</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgCopyToClipboard_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ExmgCopyToClipboard.html#copyToClipboard">copyToClipboard</a></li><li><a href="ExmgCopyToClipboard.html#handleCopyAction">handleCopyAction</a></li></ul></div></li><li><a href="ExmgDrawer.html">ExmgDrawer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgDrawer_sub"></div></li><li><a href="ExmgForm.html">ExmgForm</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgForm_sub"></div></li><li><a href="ExmgFormDrawer.html">ExmgFormDrawer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgFormDrawer_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ExmgFormDrawer.html#error">error</a></li></ul></div></li><li><a href="ExmgGrid.html">ExmgGrid</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgGrid_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="ExmgGrid.html#disableRowClickSelection">disableRowClickSelection</a></li><li><a href="ExmgGrid.html#expandedRowIds">expandedRowIds</a></li><li><a href="ExmgGrid.html#hiddenColumnNames">hiddenColumnNames</a></li><li><a href="ExmgGrid.html#items">items</a></li><li><a href="ExmgGrid.html#rowsSelectable">rowsSelectable</a></li><li><a href="ExmgGrid.html#rowsSortable">rowsSortable</a></li><li><a href="ExmgGrid.html#selectedRowIds">selectedRowIds</a></li><li><a href="ExmgGrid.html#sortable">sortable</a></li><li><a href="ExmgGrid.html#tableLayout">tableLayout</a></li></ul></div></li><li><a href="ExmgGridBaseToolbar.html">ExmgGridBaseToolbar</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgGridBaseToolbar_sub"></div></li><li><a href="ExmgGridPagination.html">ExmgGridPagination</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgGridPagination_sub"></div></li><li><a href="ExmgSidemenu.html">ExmgSidemenu</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgSidemenu_sub"></div></li><li><a href="ExmgSidemenuHeader.html">ExmgSidemenuHeader</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgSidemenuHeader_sub"></div></li><li><a href="ExmgTooltip.html">ExmgTooltip</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ExmgTooltip_sub"></div></li><li><a href="SortableElement.html">SortableElement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SortableElement_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#orientationMap">orientationMap</a></li><li><a href="global.html#selectionController">selectionController</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { __decorate } from "tslib";
import { html } from 'lit';
import { ExmgElement } from '@exmg/exmg-base';
import { property, customElement, state } from 'lit/decorators.js';
import { cache } from 'lit/directives/cache.js';
import '@exmg/exmg-sortable/exmg-sortable.js';
import { style as exmgGridTableStyles } from '../styles/exmg-grid-styles-css.js';
import { ExmgRowSelectable } from './featrues/exmg-row-selectable.js';
import { ExmgQuerySelectors } from './utils/exmg-query-selectors.js';
import { ExmgRowExpandable } from './featrues/exmg-row-expandable.js';
import { ExmgColumnSortable } from './featrues/exmg-column-sortable.js';
import { ExmgRowSortable } from './featrues/exmg-row-sortable.js';
/**
 * ### Styling
 * The following custom properties and mixins are available for styling:
 *
 * Custom property | Description | Default
 * ----------------|-------------|----------
 * `--exmg-arrow-upward-url` | Url to icon that is used for soring direction indicator | `url('/assets/arrow-upward.svg');`
 * `--exmg-table-card-width` | table card width | `100%;`
 * `--exmg-table-card-margin-bottom` | table bottom margin  | `5px;`
 * `--exmg-table-color` | table text color | `#02182b;`
 * `--exmg-table-background-color` | table background color | `#ffffff;`
 * `--exmg-table-box-shadow` | table box shadow | `#{0px 1px 5px 0px rgba($onSurface, .2), 0px 2px 2px 0px rgba($onSurface, .14), 0px 3px 1px -2px rgba($onSurface, .12)},`
 * `--exmg-table-row-divider-color` | table rows separator color | `#dbdbdb;`
 * `--exmg-table-row-selected-color` | selected row text color | `#02182b;`
 * `--exmg-table-row-selected-background-color` | selected row background color | `#e2f1fe;`
 * `--exmg-table-row-hover-color` | row hover text color | `#02182b;`
 * `--exmg-table-row-hover-background-color` | row hover background color | `#f1f1f1;`
 * `--exmg-table-row-dragged-background-color` | sortable row background color when dragged | `#f1f1f1;`
 * `--exmg-table-rows-expanded-divider-border` | border between row and expanded row detail | `none;`
 * `--exmg-table-rows-expanded-border` | border around row and expanded row detail | `1px solid #dbdbdb;`
 * `--exmg-table-rows-expanded-background-color` | background color of row and expanded row detail | `#e2f1fe;`
 * `--exmg-table-rows-expanded-color` | text color of row and expanded row detail | `#02182b;`
 * `--exmg-table-th-color` | header text color | `#0071dc;`
 * `--exmg-table-columns-background-color` | header background color | `#ffffff;`
 * `--exmg-table-th-sortable-hover-color` | sortable header hover text color | `#02182b;`
 * `--exmg-table-th-height` | header height | `48px;`
 * `--exmg-table-th-sort-margin-left` | header margin after text but before icon | `0px;`
 * `--exmg-table-td-height` | row cell height | `48px;`
 * `--exmg-table-th-sort-icon-height` | sort icon height | `1em;`
 * `--exmg-table-th-sort-icon-width` | sort icon width | `1em;`
 * `--exmg-table-col-number-padding-right` | right padding of number column | `10px;`
 * `--exmg-table-checkbox-cell-width` | width of cell with checkbox | `24px;`
 */
let ExmgGrid = class ExmgGrid extends ExmgElement {
    constructor() {
        super(...arguments);
        /**
         * Array of data which mapped to rows
         */
        this.items = [];
        /**
         * Feature that turn on sort by column
         */
        this.sortable = false;
        /**
         * Feature that allow sort rows
         * If table has turn on feature `selectable` then it takes precedence and `rowSelectable` will be ignored
         */
        this.rowsSortable = false;
        /**
         * Feature that allow select rows
         */
        this.rowsSelectable = false;
        /**
         * By default a ros is also selactable by clicking anywhere inside the row when the rowSElectable option is enabled
         */
        this.disableRowClickSelection = false;
        /**
         * Map of column names that should be hidden
         */
        this.hiddenColumnNames = {};
        /**
         * Map of row id and selection state
         * Useful for setup default selection or manipulating programmatically
         */
        this.selectedRowIds = {};
        /**
         * Map of row id and expandable row state
         * Useful for setup default expanded rows or manipulating programmatically
         */
        this.expandedRowIds = {};
        /**
         * Set table layout. If fixed then text overflow will be hidden and ellipsis added.
         */
        this.tableLayout = 'auto';
        this.withToolbar = false;
        this.componentReady = false;
    }
    getQuerySelectors() {
        if (!this.querySelectors) {
            throw new Error('ExmgQuerySelector not initialized yet');
        }
        return this.querySelectors;
    }
    getTable() {
        return this.getQuerySelectors().getTable();
    }
    getTableBody() {
        return this.getQuerySelectors().getTableBody();
    }
    findTableBody() {
        if (this.querySelectors) {
            return this.getTableBody() || undefined;
        }
        return undefined;
    }
    getColumns(selector = 'th') {
        return this.getQuerySelectors().getColumns(selector);
    }
    getBodyRowSelector(selector = '') {
        return this.getQuerySelectors().getBodyRowSelector(selector);
    }
    canSortRows() {
        return !this.sortable &amp;&amp; this.rowsSortable;
    }
    rowsOrderChange(e) {
        setTimeout(() => {
            const { sourceIndex, targetIndex } = e.detail;
            const items = [...this.items];
            const movedElement = items[sourceIndex];
            items.splice(sourceIndex, 1);
            items.splice(targetIndex, 0, movedElement);
            this.dispatchEvent(new CustomEvent('exmg-grid-rows-order-updated', {
                composed: true,
                bubbles: true,
                detail: { sourceIndex, targetIndex },
            }));
            this.dispatchEvent(new CustomEvent('exmg-grid-rows-order-changed', {
                composed: true,
                bubbles: true,
                detail: { items },
            }));
        }, 0);
    }
    updateColumnVisibility(previousHiddenColumnNames = {}) {
        let visibleColumns = 0;
        this.getColumns().forEach((column, index) => {
            const columnKey = column.getAttribute('data-column-key');
            visibleColumns += this.hiddenColumnNames[columnKey || ''] ? 0 : 1;
            if (columnKey &amp;&amp; previousHiddenColumnNames[columnKey] !== this.hiddenColumnNames[columnKey]) {
                const nextDisplayValue = this.hiddenColumnNames[columnKey] ? 'none' : 'table-cell';
                column.style.display = nextDisplayValue;
                this.getTable()
                    .querySelectorAll(`tbody.grid-data tr:not(.grid-row-detail) td:nth-child(${index + 1})`)
                    .forEach((cell) => {
                    cell.style.display = nextDisplayValue;
                });
            }
        });
        this.updateAutoColspan(visibleColumns);
    }
    updateAutoColspan(visibleColumns) {
        this.getTable()
            .querySelectorAll('[data-auto-colspan]')
            .forEach((element) => {
            const offset = Number.parseInt(element.getAttribute('data-auto-span') || '0', 10);
            element.setAttribute('colspan', (visibleColumns - offset).toString());
        });
    }
    observeExpandedRowIds(changedProps) {
        if (changedProps.has('expandedRowIds')) {
            Object.entries(this.expandedRowIds).forEach(([rowId, nextExpandedState]) => {
                const expendableToggle = this.getTableBody().querySelector(this.getBodyRowSelector(`[data-row-key="${rowId}"] ${this.expandableToggleSelector}`));
                if (expendableToggle) {
                    const isExpanded = expendableToggle.hasAttribute('data-is-expanded');
                    if (isExpanded !== nextExpandedState) {
                        expendableToggle.dispatchEvent(new MouseEvent('click'));
                    }
                }
            });
        }
    }
    observeSelectedRowIds(changedProps) {
        if (changedProps.has('selectedRowIds')) {
            Object.entries(this.selectedRowIds).forEach(([rowId, nextSelectionState]) => {
                const row = this.getTableBody().querySelector(this.getBodyRowSelector(`[data-row-key="${rowId}"]`));
                if (row) {
                    const isSelected = row.hasAttribute('data-selected');
                    if (isSelected !== nextSelectionState) {
                        row.dispatchEvent(new MouseEvent('click'));
                    }
                }
            });
        }
    }
    observeItems(changedProps) {
        if (changedProps.has('items') &amp;&amp; this.rowSelectableFeature) {
            this.rowSelectableFeature.syncSelectedItems();
        }
    }
    async initGridAttributes() {
        await this.updateComplete;
        const toolbarSlot = this.shadowRoot.querySelector('slot[name="toolbar"]');
        if (toolbarSlot &amp;&amp; toolbarSlot.assignedNodes &amp;&amp; toolbarSlot.assignedNodes().length) {
            // make TS happy - this.withToolbar is declared but never read
            this.withToolbar = this.withToolbar || true;
        }
    }
    async firstUpdated() {
        const table = this.shadowRoot.host.querySelector('table');
        const tableBody = table.querySelector('tbody.grid-data');
        this.querySelectors = new ExmgQuerySelectors(table, tableBody);
        this.initGridAttributes();
        const bodyRows = this.querySelectors.getBodyRows();
        if (this.sortable) {
            this.columnSortableFeature = new ExmgColumnSortable(this.querySelectors, (event) => this.dispatchEvent(event), this.defaultSortColumn, this.defaultSortDirection);
            this.columnSortableFeature.initFeature();
        }
        if (this.canSortRows()) {
            this.rowSortableFeature = new ExmgRowSortable(this.querySelectors);
            this.rowSortableFeature.initFeature();
        }
        if (this.rowsSelectable) {
            this.rowSelectableFeature = new ExmgRowSelectable(this.querySelectors, (event) => this.dispatchEvent(event), this.disableRowClickSelection, this.selectableCheckboxSelector);
            this.rowSelectableFeature.initFeature(bodyRows);
        }
        if (this.expandableToggleSelector) {
            this.rowExpandableFeature = new ExmgRowExpandable(this.querySelectors, this.expandableToggleSelector);
            this.rowExpandableFeature.initFeature();
        }
        this.updateColumnVisibility();
        bodyRows.forEach((row) => row.setAttribute('data-initialized', ''));
        this.querySelectors.getColumns('th:not([title])').forEach((col) => col.setAttribute('title', col.innerText));
        this.querySelectors.getTable().setAttribute('data-table-layout', this.tableLayout);
        await this.updateComplete;
        this.componentReady = true;
    }
    updated(changedProps) {
        if (changedProps.has('hiddenColumnNames') || changedProps.has('items')) {
            this.updateColumnVisibility(changedProps.get('hiddenColumnNames'));
        }
        this.observeItems(changedProps);
        this.observeExpandedRowIds(changedProps);
        this.observeSelectedRowIds(changedProps);
        if (this.componentReady &amp;&amp; changedProps.has('items')) {
            const bodyRows = this.querySelectors.getBodyRowsNotInitialized();
            if (this.rowSelectableFeature) {
                this.rowSelectableFeature.updateFeature(bodyRows);
            }
            if (this.rowExpandableFeature) {
                this.rowExpandableFeature.updateFeature();
            }
            if (this.rowSortableFeature) {
                this.rowSortableFeature.updateFeature();
            }
            bodyRows.forEach((row) => row.setAttribute('data-initialized', ''));
        }
    }
    renderWithoutSortable() {
        return html ` &lt;slot>&lt;/slot> `;
    }
    renderWithSortable() {
        return html `
      &lt;exmg-sortable
        orientation="${'vertical'}"
        animation-enabled
        item-selector="tbody.grid-data &amp;gt; tr:not(.grid-row-detail)"
        handle-selector=".grid-row-drag-handler"
        .sortableHostNode="${this.findTableBody()}"
        @dom-order-change="${this.rowsOrderChange}"
      >
        &lt;slot>&lt;/slot>
      &lt;/exmg-sortable>
    `;
    }
    render() {
        return html `
      &lt;div class="table-card-container">
        &lt;slot name="toolbar">&lt;/slot>
        &lt;div class="table-card">
          &lt;div class="table-container">${cache(this.canSortRows() ? this.renderWithSortable() : this.renderWithoutSortable())}&lt;/div>
          &lt;slot name="pagination">&lt;/slot>
        &lt;/div>
      &lt;/div>
    `;
    }
};
ExmgGrid.styles = [exmgGridTableStyles];
__decorate([
    property({ type: Array })
], ExmgGrid.prototype, "items", void 0);
__decorate([
    property({ type: Boolean, reflect: true })
], ExmgGrid.prototype, "sortable", void 0);
__decorate([
    property({ type: String, attribute: 'default-sort-column' })
], ExmgGrid.prototype, "defaultSortColumn", void 0);
__decorate([
    property({ type: String, attribute: 'default-sort-direction' })
], ExmgGrid.prototype, "defaultSortDirection", void 0);
__decorate([
    property({ type: Boolean, reflect: true, attribute: 'rows-sortable' })
], ExmgGrid.prototype, "rowsSortable", void 0);
__decorate([
    property({ type: Boolean, attribute: 'rows-selectable' })
], ExmgGrid.prototype, "rowsSelectable", void 0);
__decorate([
    property({ type: Boolean, attribute: 'disable-row-click-selection' })
], ExmgGrid.prototype, "disableRowClickSelection", void 0);
__decorate([
    property({ type: String, attribute: 'selectable-checkbox-selector' })
], ExmgGrid.prototype, "selectableCheckboxSelector", void 0);
__decorate([
    property({ type: Object })
], ExmgGrid.prototype, "hiddenColumnNames", void 0);
__decorate([
    property({ type: Object })
], ExmgGrid.prototype, "selectedRowIds", void 0);
__decorate([
    property({ type: Object })
], ExmgGrid.prototype, "expandedRowIds", void 0);
__decorate([
    property({ type: String, attribute: 'expandable-toggle-selector', reflect: true })
], ExmgGrid.prototype, "expandableToggleSelector", void 0);
__decorate([
    property({ type: String, attribute: 'table-layout', reflect: true })
], ExmgGrid.prototype, "tableLayout", void 0);
__decorate([
    state()
], ExmgGrid.prototype, "querySelectors", void 0);
__decorate([
    property({ type: Boolean, reflect: true, attribute: 'data-with-toolbar' })
], ExmgGrid.prototype, "withToolbar", void 0);
ExmgGrid = __decorate([
    customElement('exmg-grid')
], ExmgGrid);
export { ExmgGrid };
//# sourceMappingURL=exmg-grid.js.map</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://www.exmachinagroup.com/images/svg/ExMachinaPrimary.svg" style="width: 150px; height: 50px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
